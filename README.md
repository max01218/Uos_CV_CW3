# 場景識別系統

本專案實現了一個完整的場景圖像識別系統，包含三種不同的實現方法，分別採用了不同的特徵提取和分類算法。

## 專案結構

```
├── version1.py    # 實現方法一：tiny image特徵 + KNN分類器
├── version2.py    # 實現方法二：視覺詞袋 + 線性分類器
├── version3.py    # 實現方法三：密集SIFT + SVM分類器
├── requirements.txt    # 專案依賴項
├── README.md      # 專案說明文件
├── training/      # 訓練數據目錄
│   └── training/  # 包含不同場景類別的訓練圖像
├── testing/       # 測試數據目錄
│   └── testing/   # 包含待分類的測試圖像
├── run1.txt       # 方法一的預測結果
├── run2.txt       # 方法二的預測結果
├── run3.txt       # 方法三的預測結果
├── model.pkl      # 保存的模型文件
└── models.joblib  # 保存的模型文件（備用）
```

## 環境配置

### 系統要求
- Python 3.8 或更高版本
- CUDA（可選，用於GPU加速）
- 8GB 以上記憶體（推薦16GB）

### 安裝依賴
```bash
pip install -r requirements.txt
```

## 實現方法詳解

### 方法一：基於Tiny Image的場景識別
- **特徵提取**：
  - 從圖像中心裁剪正方形區域
  - 將圖像縮放至 16×16 像素
  - 將像素值轉換為特徵向量
  - 進行零均值化和單位長度歸一化
- **分類方法**：
  - 採用K近鄰（KNN）分類器
  - K值預設為3
  - 使用歐氏距離度量相似性

### 方法二：基於視覺詞袋的場景識別
- **特徵提取**：
  - 使用 8×8 像素塊進行密集採樣
  - 採樣步長為4像素
  - 對每個像素塊進行特徵提取
- **視覺詞袋建立**：
  - 使用MiniBatchKMeans聚類
  - 預設詞彙量為500
  - 應用PCA降維優化特徵
- **分類方法**：
  - 採用一對多邏輯回歸分類器
  - 使用並行計算加速處理
  - 實現模型持久化存儲

### 方法三：基於密集SIFT的場景識別
- **特徵提取**：
  - 使用密集SIFT特徵描述子
  - 在多個尺度下提取特徵 [1.0, 0.75, 0.5, 0.25]
  - 應用CLAHE對比度增強
- **特徵優化**：
  - 使用PCA降維至128維
  - 特徵標準化處理
  - FAISS加速最近鄰搜索
- **分類方法**：
  - 使用OneVsRest SVM分類器
  - 網格搜索優化超參數
  - 使用平衡權重處理類別不平衡

## 使用說明

### 訓練和測試
1. 運行方法一：
```bash
python version1.py
```

2. 運行方法二：
```bash
python version2.py
```

3. 運行方法三：
```bash
python version3.py
```

### 結果輸出
- 預測結果將保存在對應的TXT文件中
- 輸出格式：
```
圖像名稱 預測類別
例如：
0.jpg Coast
1.jpg Forest
2.jpg Highway
```

## 性能優化

### 記憶體優化
- 批量處理大型數據集
- 使用生成器處理數據
- 及時釋放不需要的記憶體

### 速度優化
- 使用並行處理加速計算
- 實現模型持久化避免重複訓練
- 使用FAISS加速特徵匹配

### 準確率優化
- 多尺度特徵提取
- 特徵標準化和降維
- 參數網格搜索優化

## 注意事項

1. 記憶體使用：
   - 處理大量圖像時需要足夠的記憶體
   - 可通過調整批次大小控制記憶體使用

2. GPU加速：
   - 如需使用GPU，請安裝CUDA和對應版本的faiss-gpu
   - 在requirements.txt中將faiss-cpu替換為faiss-gpu

3. 模型保存：
   - 模型訓練完成後會自動保存
   - 下次運行時會優先載入已保存的模型

## 故障排除

1. 記憶體不足：
   - 減少batch_size
   - 降低特徵維度
   - 減少並行處理線程數

2. 模型收斂問題：
   - 增加最大迭代次數
   - 調整學習率
   - 檢查特徵標準化

3. 預測結果異常：
   - 檢查數據預處理
   - 驗證特徵提取過程
   - 確認模型保存和載入是否正確

## 維護者

如有任何問題，請聯繫專案維護者。 